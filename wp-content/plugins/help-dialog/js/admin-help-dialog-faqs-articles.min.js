jQuery(document).ready(function(e){function t(){let t=e(".ephd-all-questions-list-container .ephd-faq-question-container").length,i=e(".ephd-all-questions-list-container .ephd-faq-question--active").length;e("#ephd-admin__no-question-message, #ephd-admin__assigned-question-message").hide(),0===t&&e("#ephd-admin__no-question-message").show(),0===i&&t>0&&e("#ephd-admin__assigned-question-message").show()}function i(){e("#ephd-help-dialog #ephd-hd__search-terms").prop("disabled",!0)}function a(){if(!e(".ephd-fp__wp-editor").hasClass("active"))return;let t=tinymce.get("ephd-fp__wp-editor");e(".ephd-fp__wp-editor__language-"+g).length&&(e(".ephd-fp__wp-editor__language").removeClass("ephd-fp__wp-editor__language--active"),e(".ephd-fp__wp-editor__language-"+g).addClass("ephd-fp__wp-editor__language--active")),void 0===v[g]&&(v[g]={title:"",content:"",faq_id:0,id:0}),e("#ephd-fp__wp-editor__question-title").val(v[g].title),null==t?e("#ephd-fp__wp-editor").val(v[g].content):t.setContent(v[g].content),e(".ephd-characters_left-counter").text(v[g].content.length+"")}function n(t){q=setInterval(d,1e3);for(let e in v)v[e]={title:"",content:"",faq_id:0,id:0};if(void 0===t||!t)return e(".ephd-fp__wp-editor").addClass("active"),void a();f({action:"ephd_get_question_data",question_id:t,_wpnonce_ephd_ajax_action:ephd_help_dialog_vars.nonce},function(t){if(!t.error&&void 0!==t.data){for(let e in t.data)v[e]=t.data[e];void 0!==t.language&&t.language&&(g=t.language),e(".ephd-fp__wp-editor").addClass("active"),a()}})}function d(){let t=e("#ephd-fp__wp-editor__question-title");if(t.length){let i=t.val().length;i>200?(e(".ephd-fp__wp-editor__question .ephd-characters_left-counter").text(200),t.val(t.val().substring(0,200))):e(".ephd-fp__wp-editor__question .ephd-characters_left-counter").text(i)}if(e("#ephd-fp__wp-editor").length){let t=tinymce.get("ephd-fp__wp-editor"),i="";(i=t&&e(".wp-editor-wrap").hasClass("tmce-active")?t.getContent():e("#ephd-fp__wp-editor").val()).length>1500&&(i=i.substring(0,1500),t&&t.setContent(i),e("#ephd-fp__wp-editor").val(i)),e(".ephd-fp__wp-editor__answer .ephd-characters_left-counter").text(i.length)}}function o(){tinyMCE.triggerSave(),v[g].title=e("#ephd-fp__wp-editor__question-title").val(),v[g].content=e("#ephd-fp__wp-editor").val()}function s(){e(".ephd-all-questions-list-container .ephd-faq-question-container.ephd-faq-question--active").length?e(".ephd__top-section__filter label, #ephd_all_articles_filter").removeClass("ephd__top-section__filter--disabled"):e("#ephd_all_articles_filter").val()?e(".ephd__top-section__filter label, #ephd_all_articles_filter").removeClass("ephd__top-section__filter--disabled"):e(".ephd__top-section__filter label, #ephd_all_articles_filter").addClass("ephd__top-section__filter--disabled")}function _(a){t();f(function(e,t){let i=e.find('[name="widget_id"]').val();return{action:t,_wpnonce_ephd_ajax_action:ephd_help_dialog_vars.nonce,widget_id:i,faqs_sequence:e.find('[name="faqs_sequence"]').val().split(",")}}(e(a).closest(".ephd-fp__faqs-form--active"),"ephd_update_faqs_preview"),function(t){t.error||void 0===t.preview||(e(".ephd-fp__widget-preview-content").html(t.preview),e("#ephd-public-styles-inline-css").html(t.demo_styles),setTimeout(function(){e(window).trigger("resize")},50),p(),h(),i())},!1,!1,void 0,e(".ephd-fp__widget-preview-content"))}function p(){e(".ephd-fp__widget-preview #ephd-help-dialog .ephd-hd-faq__list__item-container").each(function(){let t=e(this).data("id"),i=e(".ephd-fp__faqs-form--active .ephd-faq-question__buttons_template").html();e(i).appendTo(this).attr("data-id",t)})}function l(){let t=e(".ephd-all-questions-list-container"),i=t.children(".ephd-faq-question-container");i.detach().sort(function(t,i){let a=e(t).data("modified"),n=e(i).data("modified");return parseInt(a)<=parseInt(n)?0:-1}),t.append(i)}function h(){e(".ephd-hd-faq__faqs-container").sortable({axis:"y",forceHelperSize:!0,forcePlaceholderSize:!0,placeholder:"ephd-sortable-placeholder",update:function(t,i){let a=new Array;e(this).find(".ephd-hd-faq__list__item-container").each(function(t){a.push(e(this).data("id"))}),e(".ephd-fp__faqs-form--active").find('[name="faqs_sequence"]').val(a.join(","))}})}function f(t,i,a,n,d,o){let s,_;i=void 0===i?"ephd_callback_noop":i,e.ajax({type:"POST",dataType:"json",data:t,url:ajaxurl,beforeSend:function(e){void 0!==o&&!1!==o||r("show",""),"object"==typeof o&&r("show","",o)}}).done(function(e){((_=e||"").error||void 0===_.message)&&(s=_.message?_.message:c("",ephd_vars.reload_try_again,"error"))}).fail(function(e,t,i){s=i?" ["+i+"]":ephd_vars.unknown_error,s=c(ephd_vars.error_occurred+". "+ephd_vars.msg_try_again,s,"error")}).always(function(){if(_=void 0===_?"":_,"function"==typeof d&&d(_),void 0!==o&&!1!==o||r("remove",""),"object"==typeof o&&r("remove","",o),s)return e(".ephd-bottom-notice-message").remove(),e("body #ephd-admin-page-wrap").append(s).removeClass("fadeOutDown"),void setTimeout(function(){e(".ephd-bottom-notice-message").addClass("fadeOutDown")},1e4);"function"==typeof i?"undefined"===a?i(_):i(_,a):n&&location.reload()})}function r(t,i,a){if("show"===t){let t=void 0===a?"":"ephd-admin-dialog-box-loading--relative",n='<div class="ephd-admin-dialog-box-loading '+t+'"><div class="ephd-admin-dbl__header"><div class="ephd-admin-dbl-icon ephdfa ephdfa-hourglass-half"></div>'+(i?'<div class="ephd-admin-text">'+i+"</div>":"")+'</div></div><div class="ephd-admin-dialog-box-overlay '+t+'"></div>';void 0===a?e("body").append(n):a.append(n).addClass("ephd-loading-white-opacity")}else"remove"===t&&(e(".ephd-admin-dialog-box-loading").remove(),e(".ephd-admin-dialog-box-overlay").remove(),void 0!==a&&a.removeClass("ephd-loading-white-opacity"))}function c(e,t,i){return'<div class="ephd-bottom-notice-message"><div class="contents"><span class="'+i+'">'+(e?"<h4>"+e+"</h4>":"")+(t?"<p>"+t+"</p>":"")+'</span></div><div class="ephd-close-notice ephdfa ephdfa-window-close"></div></div>'}function u(t,i=""){e(".ephd-bottom-notice-message").remove(),e("body #ephd-admin-page-wrap").append(c(i,t,"error")),clearTimeout(w),w=setTimeout(function(){e(".ephd-bottom-notice-message").addClass("fadeOutDown")},1e4)}function m(t,i=""){e(".ephd-bottom-notice-message").remove(),e("body #ephd-admin-page-wrap").append(c(i,t,"success")),clearTimeout(w),w=setTimeout(function(){e(".ephd-bottom-notice-message").addClass("fadeOutDown")},1e4)}e(document).on("click",".ephd-admin__item-preview .ephd_edit_item, .ephd-admin__item-preview .ephd-admin__item-preview__sub-items-btn, .ephd-fp__create-new-faqs-btn",function(a){a.preventDefault();let n=e(this).data("id"),d=e(this).closest(".ephd-admin__item-preview").find("#faqs_name").val();f({action:"ephd_load_faqs_form",_wpnonce_ephd_ajax_action:ephd_help_dialog_vars.nonce,widget_id:void 0!==n?n:0,faqs_name:d},function(a){a.error||void 0===a.faqs_form||(e(".ephd-fp__create-new-faqs-btn, .ephd__welcome-message").hide(),e(".ephd-fp__faqs-form").replaceWith(a.faqs_form),e(".ephd-fp__widget-preview-content").html(a.preview),e(".ephd-fp__widget-preview").show(),e(".ephd-admin__item-preview").hide(),e(".ephd-admin__add-new-item-preview").find("#faqs_name").val(""),e("#ephd-public-styles-inline-css").html(a.demo_styles),p(),h(),t(),s(),i())})}),e(document).on("click",".ephd-fp__faqs-form .ephd_save_faqs",function(){let t=e(this).closest(".ephd-fp__faqs-form"),i=t.find('[name="widget_id"]').val(),a=e(this).closest(".ephd-fp__faqs-form").find('[name="faqs_sequence"]').val().split(",");f({action:"ephd_save_faqs",_wpnonce_ephd_ajax_action:ephd_help_dialog_vars.nonce,widget_id:i,faqs_name:t.find('[name="faqs_name"]').val(),faqs_sequence:a},function(a){a.error||void 0===a.message||(m(a.message),t.replaceWith(a.faqs_form),e(".ephd-admin__item-preview--"+i).length?e(".ephd-admin__item-preview--"+i).replaceWith(a.faqs_preview):e(a.faqs_preview).insertBefore(".ephd-fp__faqs-form"),e(".ephd-admin__item-preview").hide(),p(),s())})}),e(document).on("click",".ephd_cancel_faqs",function(t){return t.preventDefault(),e(".ephd-fp__faqs-form").removeClass("ephd-fp__faqs-form--active"),e(".ephd-admin__item-preview").show(),e(".ephd-fp__widget-preview").hide(),e(".ephd-fp__create-new-faqs-btn, .ephd__welcome-message").show(),!1});let q=!1,v={},g="";e(".ephd-fp__wp-editor__languages").length?(e(".ephd-fp__wp-editor__language").each(function(){v[e(this).data("slug")]={title:"",content:"",faq_id:0,id:0}}),g=e(".ephd-fp__wp-editor__language").first().data("slug")):(v[ephd_vars.default_language]={title:"",content:"",faq_id:0,id:0},g=ephd_vars.lang),e(".ephd__help_editor__action__cancel, .ephd-fp__wp-editor__overlay").on("click",function(){return e(".ephd-fp__wp-editor").removeClass("active"),clearInterval(q),!1}),e("#ephd-fp__article-form").on("submit",function(i){if(i.preventDefault(),d(),o(),void 0===v[ephd_vars.default_language])return u(ephd_vars.reload_try_again),!1;if(!v[ephd_vars.default_language].title)return u(ephd_vars.empty_default_language),e(".ephd-fp__wp-editor__language-"+ephd_vars.default_language).trigger("click"),!1;let a={action:"ephd_save_question_data",_wpnonce_ephd_ajax_action:ephd_help_dialog_vars.nonce,faqs_id:e("#faqs_id").val(),question_languages:[]};for(let e in v)a.question_languages.push(e),a["question_id_"+e]=v[e].id,a.question_faq_id||(a.question_faq_id=v[e].faq_id),a["question_title_"+e]=v[e].title,a["question_content_"+e]=v[e].content;return f(a,function(i){i.error||void 0===i.message||(m(i.message),i.data.forEach(function(t){e(".ephd-faq-question--"+t.faq_id).length?e(".ephd-faq-question--"+t.faq_id+" .ephd-faq-question__text").text(t.title):e(t.html).appendTo(".ephd-all-questions-list-container").addClass("ui-sortable-handle")}),e(".ephd-fp__wp-editor").removeClass("active"),l(),t(),s(),_(e(".ephd-fp__faqs-form--active").find('[name="faqs_sequence"]')))}),!1}),e(".ephd-fp__wp-editor__language").on("click",function(){o(),g=e(this).data("slug"),a()}),e(document).on("click","#ephd-fp__add_new_question",function(e){return e.preventDefault(),n(),!1}),e(document).on("click",".ephd-faq-question__edit",function(){n(e(this).closest(".ephd-faq-question").data("id"))}),e(document).on("change keyup","#ephd_all_articles_filter",function(){let t=e(this).val().toLowerCase().trim(),i=e(".ephd-fp__faqs-form--active").find('[name="faqs_sequence"]').val().split(",");e(".ephd-all-questions-list-container .ephd-faq-question-container").each(function(){if(i.includes(e(this).data("id").toString()))return;let a=e(this).find(".ephd-faq-question__text").text();!t.length||~a.toLowerCase().indexOf(t)?e(this).addClass("ephd-faq-question--active"):e(this).removeClass("ephd-faq-question--active")}),s()}),e(document).on("click",".ephd-faq-question__delete",function(){let t=e(this).closest(".ephd-faq-question-container").data("id");if(void 0===t||!t)return void u(ephd_vars.reload_try_again);e("#ephd-fp_delete-question-confirmation-id").val(t);let i=e("#ephd-fp_delete-question-confirmation"),a=e('.ephd-fp__faqs-form--active input[name="widget_id"]').val();e(".ephd-admin__confirm-dialog-assigned-widgets").hide(),i.find(".ephd-admin__confirm-dialog-assigned-widget").each(function(){e(this).data("faq-sequence").toString().split(",").includes(t.toString())&&e(this).data("widget-id").toString()!==a.toString()?(e(".ephd-admin__confirm-dialog-assigned-widgets").show(),e(this).show()):e(this).hide()}),i.addClass("ephd-dialog-box-form--active")}),e("#ephd-fp_delete-question-confirmation form").on("submit",function(){let i=e("#ephd-fp_delete-question-confirmation-id").val();if(void 0===i||!i)return void u(ephd_vars.reload_try_again);return f({action:"ephd_delete_question",faq_id:i,_wpnonce_ephd_ajax_action:ephd_help_dialog_vars.nonce},function(a){if(!a.error&&void 0!==a.message){m(a.message);for(let t in a.faqs_preview){let i=e(".ephd-admin__item-preview--"+t);i.length?i.replaceWith(a.faqs_preview[t]):e(a.faqs_preview[t]).insertBefore(".ephd-fp__faqs-form")}e(".ephd-admin__item-preview").hide(),e(".ephd-faq-question--"+i+", .ephd-fp__faqs__question--"+i).remove()}t(),e("#ephd-fp_delete-question-confirmation").removeClass("ephd-dialog-box-form--active")}),!1}),e(document).on("click",".ephd-faq-question__move_right",function(){let t=e(this).closest(".ephd-faq-question").data("id"),i=e(".ephd-fp__faqs-form--active").find('[name="faqs_sequence"]'),a=i.val().split(",");e(".ephd-fp__faqs-form--active .ephd-faq-question--"+t).addClass("ephd-faq-question--active"),a=a.filter(function(e){return e!=t}),i.val(a),_(i),s()}),e(document).on("click",".ephd-faq-question__add",function(){let t=e(this).closest(".ephd-faq-question-container").data("id"),i=e(".ephd-fp__faqs-form--active").find('[name="faqs_sequence"]'),a=i.val().split(",");e(this).closest(".ephd-faq-question-container").removeClass("ephd-faq-question--active"),a.push(t),i.val(a),_(i),s()}),e(document).on("mouseenter",".ephd-faq-question__delete",function(){e(this).closest(".ephd-faq-question-container").addClass("ephd-faq-question--delete-highlight")}),e(document).on("mouseleave",".ephd-faq-question__delete",function(){e(this).closest(".ephd-faq-question-container").removeClass("ephd-faq-question--delete-highlight")}),e(document).on("mouseenter",".ephd-faq-question__add",function(){e(this).closest(".ephd-faq-question-container").addClass("ephd-faq-question--move_left-highlight")}),e(document).on("mouseleave",".ephd-faq-question__add",function(){e(this).closest(".ephd-faq-question-container").removeClass("ephd-faq-question--move_left-highlight")}),e(document).on("mouseenter",".ephd-faq-question__move_right",function(){e(this).closest(".ephd-faq-question-container").addClass("ephd-faq-question--move_right-highlight")}),e(document).on("mouseleave",".ephd-faq-question__move_right",function(){e(this).closest(".ephd-faq-question-container").removeClass("ephd-faq-question--move_right-highlight")}),e(document).on("mouseenter",".ephd-faq-question__edit",function(){e(this).closest(".ephd-faq-question-container").addClass("ephd-faq-question--edit-highlight")}),e(document).on("mouseleave",".ephd-faq-question__edit",function(){e(this).closest(".ephd-faq-question-container").removeClass("ephd-faq-question--edit-highlight")}),l(),s(),e("body").on("click",".ephd__hdl__action__reload input",function(){location.reload()});let w});